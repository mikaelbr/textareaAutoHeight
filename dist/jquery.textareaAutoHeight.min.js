/**
 *  This jQuery Plugin, textareaAutoHeight, will allow textareas to automaticly 
 *  justify it's height when texts is written. If a new line occurs, or the text
 *  starts at the next line, the textarea will expand in height.
 *  
 *  Documentation: https://github.com/mikaelbr/textareaAutoHeight#readme
 *  URL: https://github.com/mikaelbr/textareaAutoHeight
 *  Author: Mikael Brevik <mikaelbre@gmail.com>
 *  Version: 0.1
 *  Date: Tue Jul 10 22:10:14 2012 +0200
 **/
(function(a){var b={init:function(c){return this.each(function(){var d=a(this),e=d.data("textareaAutoHeight");if(!e){var f=a.extend({},a.fn.textareaAutoHeight.defaults,c);f.submitButton||(f.submitButton=d.parents("form").find("input[type='submit']:first")),d.data("textareaAutoHeight",{_settings:f}),b._render.call(this),b._bindEventHandlers.call(this)}})},_render:function(){var b=a(this),c=b.data("textareaAutoHeight");b.addClass("textareaAutoHeight-message-box textareaAutoHeight-init"),c._settings.hideSubmitButton&&c._settings.submitButton.hide();var d=b.css("font-size"),e=Math.floor(parseInt(d.replace("px",""),10)*1.3),f=c._settings.minLines*e;b.height(f),c._settings.useCounter&&(c.counterSpan=a("<span />",{"class":"textareaAutoHeight-counter",text:"0"}).insertAfter(b)),c.target=b},_fixTextareaHeight:function(b){var c=a(this),d=c.data("textareaAutoHeight"),e=c.css("font-size"),f=Math.floor(parseInt(e.replace("px",""),10)*1.3),g=c.height();g<d._settings.maxLines*f&&c.get(0).scrollHeight>c.outerHeight()&&c.height(g+f)},_bindEventHandlers:function(){var c=a(this),d=c.data("textareaAutoHeight");c.on("keydown",function(a){b._doNewLineOrSubmit.call(c,a)}),d._settings.useCounter&&(d.target.on("keyup",function(a){b._countLettersTyped.call(c,a)}),c.on("textareaAutoHeight.newtype",b._updateLetterCounter)),c.on("keyup",b._fixTextareaHeight),c.on("textareaAutoHeight.submit",function(){d._settings.submitButton.trigger("click")})},_countLettersTyped:function(b){var c=a(this),d=c.data("textareaAutoHeight");d._settings.useDiv?d.letters=d.target.getPreText().length:d.letters=d.target.val().length,c.trigger("textareaAutoHeight.newtype")},_updateLetterCounter:function(){var b=a(this),c=b.data("textareaAutoHeight");c.counterSpan.text(c.letters)},_doNewLineOrSubmit:function(b){var c=a(this),d=c.data("textareaAutoHeight");return b.keyCode!==13?!0:b.shiftKey?!0:(b.preventDefault(),c.trigger("textareaAutoHeight.submit"),!1)},options:function(b){var c=a(this),d=c.data("textareaAutoHeight");return b?(d._settings=a.extend({},d._settings,b),this):d._settings},remove:function(b){var c=a(this).data("textareaAutoHeight");return a("div.textareaAutoHeight-message-box").remove(),c.counterSpan.remove(),a(this).removeClass("textareaAutoHeight-message-box").removeClass("textareaAutoHeight-init").data("textareaAutoHeight",undefined),this},numLetters:function(){return a(this).data("textareaAutoHeight").letters}};a.fn.textareaAutoHeight=function(c){return typeof c=="string"&&c.substr(0,1)!=="_"&&b[c]?b[c].apply(this,Array.prototype.slice.call(arguments,1)):typeof c=="object"||!c?b.init.apply(this,arguments):(a.error("Method "+c+" does not exist on jQuery.textareaAutoHeight"),this)},a.fn.textareaAutoHeight.defaults={useCounter:!0,minLines:2,maxLines:5,hideSubmitButton:!0,submitButton:undefined}})(jQuery);